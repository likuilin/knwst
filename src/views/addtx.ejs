<!doctype html>
<html>
<head>
  <title>knwst - Add Transaction</title>
  <script>
  /// sigh, javascript oh javascript https://stackoverflow.com/questions/6982692/how-to-set-input-type-dates-default-value-to-today
  function toDateInputValue(dateObject) {
    const local = new Date(dateObject);
    local.setMinutes(dateObject.getMinutes() - dateObject.getTimezoneOffset());
    return local.toJSON().slice(0,10);
  };
  window.onload = () => {
    document.getElementById("date").value = toDateInputValue(new Date());
  }
  </script>
</head>
<body>
  <h1>knwst - Add Transaction</h1>
  <p><a href="/">Home</a></p>
  <form action="do_addtx" method="post">
    <table>
      <tr>
        <td><label for="date">Date</label></td>
        <td><input type="date" id="date" name="date" /></td>
      </tr>
      <tr>
        <td><label for="ttype">Type</label></td>
        <td><select name="ttype" id="ttype">
          <% for (const t of ["stock", "index", "option", "crypto", "physical"]) { %>
            <option value="<%= t %>"><%= t %></option>
          <% } %>
        </select></td>
      </tr>
      <tr>
        <td><label for="ticker">Ticker</label></td>
        <td><input type="text" id="ticker" name="ticker" /></td>
      </tr>
      <tr>
        <td><label for="action">Action</label></td>
        <td><select name="action" id="action">
          <% for (const t of ["buy", "sell", "short sell", "buy close", "dividend"]) { %>
            <option value="<%= t %>"><%= t %></option>
          <% } %>
        </select></td>
      </tr>
      <tr>
        <td><label for="amount">Amount</label></td>
        <td><input type="number" step="0.0001" id="amount" name="amount" /></td>
      </tr>
      <tr>
        <td><label for="price_comment">Price (X)</label></td>
        <td><input type="number" step="0.0001" id="price_comment" name="price_comment" /></td>
      </tr>
      <tr>
        <td><label for="comm_comment">Comm (X)</label></td>
        <td><input type="number" step="0.0001" id="comm_comment" name="comm_comment" /></td>
      </tr>
      <tr>
        <td><label for="net">Net</label></td>
        <td><input type="number" step="0.0001" id="net" name="net" /></td>
      </tr>
      <tr>
        <td><label for="brokerage">Brokerage</label></td>
        <td><select name="brokerage" id="brokerage">
          <% for (const t of env.BROKERAGES_LIST.split(",").map(e=>e.split("=")[0])) { %>
            <option value="<%= t %>"><%= t %></option>
          <% } %>
        </select></td>
      </tr>
      <tr>
        <td><label for="locate">Locate Lot</label></td>
        <td><input type="text" id="locate" name="locate" /></td>
      </tr>
      <tr>
        <td><label for="locate_basis">Locate Partial Basis</label></td>
        <td><input type="number" step="0.0001" id="locate_basis" name="locate_basis" /></td>
      </tr>
      <tr>
        <td><label for="note_comment">Note (X)</label></td>
        <td><input type="text" id="note_comment" name="note_comment" /></td>
      </tr>
      <tr>
        <td><label for="confirm_comment">Confirmation (X)</label></td>
        <td><input type="text" id="confirm_comment" name="confirm_comment" /></td>
      </tr>
      <tr>
        <td></td>
        <td><input type="submit" value="Add Transaction" /></td>
      </tr>
    </table>
  </form>
</body>
</html>
